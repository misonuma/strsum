## Unsupervised Neural Single-Document Summarization of Reviews via Learning Latent Discourse Structure and its Ranking

Corresponding paper: 

https://arxiv.org/abs/1906.05691  
Masaru Isonuma, Juncihiro Mori and Ichiro Sakata (The University of Tokyo)  
Accepted in ACL 2019 as a long paper  


### Requirements

Tensorflow

### Usage

#### Preprocessing

The pre-processed Amazon Sports & Outdoors review data can be used: `data/sports.pkl`  

To use other dataset, run: 

```
python create_dataframe.py --input_path /path/to/gzip/file --output_path /path/to/dataframe
python preprocess_data.py --input_path /path/to/dataframe --output_path /path/to/data
```

Other dataset can be downloaded http://jmcauley.ucsd.edu/data/amazon/  
Set `/path/to/gzip/file` as the path of raw gzip file

#### Training

To train your model, run:

```
python cli.py --mode train --data /path/to/data --modeldir /path/to/a/model/directory  
```

Parameters and logs are saved in `/path/to/a/model/directory`  
The hyper parameters can be chaneged as described in `cli.py`  

#### Evaluation

To write out and evaluate the summaries generated by your model, run:  

```
python cli.py --mode eval --modeldir model_rougel --refdir /path/to/ref --outdir /path/to/out
```

References and system summaries are respectively saved in `/path/to/ref` and `/path/to/out`  
The same hyper parameters must be set as used for training
